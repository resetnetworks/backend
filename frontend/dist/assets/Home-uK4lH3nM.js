import{u as te,a as le,b as m,r as a,i as ae,k as ie,m as re,n as V,j as s,o as ne,p as ce}from"./index-Bq32TEZ8.js";import{U as oe,L as b}from"./UserLayout-yuTYACIF.js";import{S as de,a as i}from"./index-rtsjbbxS.js";/* empty css                 */import{O as me}from"./OneTimePaymentModal-Trly3YgJ.js";import{s as he,a as xe}from"./artistsSelectors-BMpZxlMU.js";import{U as pe}from"./UserHeader-qhcX_yJu.js";import{R as z,A as ue}from"./AlbumCard-B1j6kRLN.js";import{S as ge}from"./SongList-CIZ81_nY.js";import{f as fe}from"./index-DsaIwXDl.js";import"./IconHeader-BhAI_0tO.js";import"./assets-Dbh41_OJ.js";import"./iconBase-Cst9Bakk.js";import"./index-B6qKfaA3.js";import"./index-BB54KNlg.js";import"./index-BLpoeeon.js";const Le=()=>{const n=te(),I=le(),o=m(e=>e.player.selectedSong),g=m(e=>e.songs.status),L=m(e=>e.songs.totalPages),d=m(e=>e.auth.user),E=m(e=>e.albums.loading),M=m(e=>e.albums.pagination.totalPages),v=m(e=>e.albums.allAlbums),x=m(he),q=m(xe),[N,G]=a.useState(1),[k,J]=a.useState(1),[O]=a.useState(1),[f,Q]=a.useState(1),[y,W]=a.useState([]),[S,X]=a.useState([]),[Z,B]=a.useState(!1),[P,D]=a.useState(null),[K,F]=a.useState(null),[u,_]=a.useState({recent:!1,topPicks:!1,albums:!1}),j={recent:a.useRef(),topPicks:a.useRef(),albums:a.useRef()},h={recent:a.useRef(null),playlist:a.useRef(null),similar:a.useRef(null),topPicks:a.useRef(null)};a.useEffect(()=>{n(ae()),n(ie({page:O,limit:10}))},[n,O]),a.useEffect(()=>{n(re({page:f,limit:10}))},[n,f]),a.useEffect(()=>{n(V({type:"recent",page:N,limit:10})).then(e=>{var t;(t=e.payload)!=null&&t.songs&&X(l=>{const r=new Set(l.map(c=>c._id)),p=e.payload.songs.filter(c=>!r.has(c._id));return[...l,...p]}),_(l=>({...l,recent:!1}))})},[n,N]),a.useEffect(()=>{n(V({type:"top",page:k,limit:20})).then(e=>{var t;(t=e.payload)!=null&&t.songs&&W(l=>{const r=new Set(l.map(c=>c._id)),p=e.payload.songs.filter(c=>!r.has(c._id));return[...l,...p]}),_(l=>({...l,topPicks:!1}))})},[n,k]);const w=e=>{e.current&&e.current.scrollBy({left:200,behavior:"smooth"})},A=e=>{n(ne(e)),n(ce())},R=(e,t)=>{D(e),F(t),B(!0)},H=5,C=[];for(let e=0;e<y.length;e+=H)C.push(y.slice(e,e+H));const T=(e,t,l,r,p)=>a.useCallback(c=>{p==="loading"||u[e]||!r||(j[e].current&&j[e].current.disconnect(),j[e].current=new IntersectionObserver(se=>{se[0].isIntersecting&&t<r&&(_($=>({...$,[e]:!0})),l($=>$+1))}),c&&j[e].current.observe(c))},[p,t,r,u[e]]),Y=T("recent",N,G,L,g),U=T("topPicks",k,J,L,g),ee=T("albums",f,Q,M||1,E==="loading"?"loading":"idle");return s.jsxs(oe,{children:[s.jsx(pe,{}),s.jsxs(de,{baseColor:"#1f2937",highlightColor:"#374151",children:[s.jsxs("div",{className:"text-white px-4 py-2 flex flex-col gap-4",children:[s.jsxs("div",{className:"w-full flex justify-between items-center",children:[s.jsx("h2",{className:"md:text-xl text-lg font-semibold",children:"new tracks"}),s.jsx(b,{className:"text-white cursor-pointer text-lg hover:text-blue-800 transition-all md:block hidden",onClick:()=>w(h.recent)})]}),s.jsxs("div",{ref:h.recent,className:"flex gap-4 overflow-x-auto pb-2 no-scrollbar min-h-[160px]",children:[g==="loading"&&S.length===0?[...Array(10)].map((e,t)=>s.jsxs("div",{className:"w-[160px] flex flex-col gap-2 skeleton-wrapper",children:[s.jsx(i,{height:160,width:160,className:"rounded-xl"}),s.jsx(i,{width:100,height:12})]},`recent-skeleton-${t}`)):S.map((e,t)=>{var l;return s.jsx(z,{ref:t===S.length-1?Y:null,title:e.title,price:e.price===0?"album":e.accessType==="purchase-only"?(l=d==null?void 0:d.purchasedSongs)!=null&&l.includes(e._id)?"Purchased":s.jsxs("button",{className:"bg-indigo-600 hover:bg-indigo-700 text-white sm:text-xs text-[10px] sm:px-2 px-1 mt-2 sm:mt-0 py-1 rounded",onClick:()=>R(e,"song"),children:["₹",e.price]}):"Subs..",singer:e.singer,image:e.coverImage||"/images/placeholder.png",onPlay:()=>A(e),isSelected:(o==null?void 0:o._id)===e._id},e._id)}),u.recent&&s.jsxs("div",{className:"w-[160px] flex flex-col gap-2 skeleton-wrapper",children:[s.jsx(i,{height:160,width:160,className:"rounded-xl"}),s.jsx(i,{width:100,height:12})]})]}),s.jsxs("div",{className:"w-full flex justify-between items-center",children:[s.jsx("h2",{className:"md:text-xl text-lg font-semibold",children:"new albums for you"}),s.jsx(b,{className:"text-white cursor-pointer text-lg hover:text-blue-800 transition-all md:block hidden",onClick:()=>w(h.playlist)})]}),s.jsxs("div",{ref:h.playlist,className:"flex gap-4 overflow-x-auto pb-2 no-scrollbar whitespace-nowrap min-h-[220px]",children:[E&&v.length===0?[...Array(7)].map((e,t)=>s.jsxs("div",{className:"min-w-[160px] flex flex-col gap-2 skeleton-wrapper",children:[s.jsx(i,{height:160,width:160,className:"rounded-xl"}),s.jsx(i,{width:100,height:12})]},`playlist-skeleton-${t}`)):v.map((e,t)=>{var l,r;return s.jsx("div",{ref:t===v.length-1?ee:null,children:s.jsx(ue,{tag:`#${e.title||"music"}`,artists:((l=e.artist)==null?void 0:l.name)||"Various Artists",image:e.coverImage||"/images/placeholder.png",price:e.price===0?"subs..":(r=d==null?void 0:d.purchasedAlbums)!=null&&r.includes(e._id)?"Purchased":s.jsxs("button",{className:"bg-indigo-600 hover:bg-indigo-700 text-white sm:text-xs text-[10px] sm:px-2 px-1 sm:mt-0 py-1 rounded",onClick:()=>R(e,"album"),children:["₹",e.price]}),onClick:()=>I(`/album/${e.slug}`)})},e._id)}),u.albums&&f<M&&s.jsxs("div",{className:"min-w-[160px] flex flex-col gap-2 skeleton-wrapper",children:[s.jsx(i,{height:160,width:160,className:"rounded-xl"}),s.jsx(i,{width:100,height:12})]})]}),x?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex md:gap-2 gap-4 items-center",children:[s.jsx("img",{src:(x==null?void 0:x.image)||"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQqfAcDALkSsCqPtfyFv69i8j0k_ZXVBM-Juw&s",alt:x.name,className:"md:w-12 md:h-12 w-8 h-8 object-cover rounded-full border-blue-800 border shadow-[0_0_5px_1px_#3b82f6]"}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-blue-700 text-base leading-none",children:"similar to"}),s.jsx("p",{onClick:()=>I(`/artist/${x.slug}`),className:"text-lg leading-none text-white hover:underline cursor-pointer",children:x.name})]}),s.jsx(b,{className:"text-white cursor-pointer text-lg hover:text-blue-800 transition-all ml-auto md:block hidden",onClick:()=>w(h.similar)})]}),q.length===0?s.jsx("p",{className:"text-gray-400 italic",children:"No songs available for this artist."}):s.jsx("div",{ref:h.similar,className:"flex gap-4 overflow-x-auto pb-2 no-scrollbar min-h-[160px]",children:q.map(e=>{var t;return s.jsx(z,{title:e.title,price:e.accessType==="purchase-only"?(t=d==null?void 0:d.purchasedSongs)!=null&&t.includes(e._id)?"Purchased":s.jsxs("button",{className:"bg-indigo-600 hover:bg-indigo-700 text-white text-xs px-2 py-1 rounded",onClick:()=>R(e,"song"),children:["Buy for ₹",e.price]}):"Subs..",singer:e.singer,image:e.coverImage||"/images/placeholder.png",onPlay:()=>A(e),isSelected:(o==null?void 0:o._id)===e._id},e._id)})})]}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex md:gap-2 gap-4 items-center",children:[s.jsx(i,{circle:!0,width:48,height:48}),s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsx(i,{width:80,height:14}),s.jsx(i,{width:100,height:18})]})]}),s.jsx("div",{className:"flex gap-4 overflow-x-auto pb-2 no-scrollbar min-h-[160px]",children:[...Array(10)].map((e,t)=>s.jsxs("div",{className:"w-[160px] flex flex-col gap-2 skeleton-wrapper",children:[s.jsx(i,{height:160,width:160,className:"rounded-xl"}),s.jsx(i,{width:100,height:12})]},`similar-skeleton-${t}`))})]}),s.jsxs("div",{className:"w-full flex justify-between items-center",children:[s.jsx("h2",{className:"md:text-xl text-lg font-semibold",children:"all tracks for you"}),s.jsx(b,{className:"text-white cursor-pointer text-lg hover:text-blue-800 transition-all md:block hidden",onClick:()=>w(h.topPicks)})]}),s.jsx("div",{ref:h.topPicks,className:"w-full overflow-x-auto no-scrollbar min-h-[280px]",children:s.jsxs("div",{className:"flex md:gap-8 gap-32",children:[g==="loading"&&y.length===0?[...Array(5)].map((e,t)=>s.jsx("div",{className:"flex flex-col gap-4 min-w-[400px]",children:[...Array(5)].map((l,r)=>s.jsxs("div",{className:"flex items-center gap-4 skeleton-wrapper",children:[s.jsx(i,{height:50,width:50,className:"rounded-full"}),s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsx(i,{width:120,height:14}),s.jsx(i,{width:80,height:12})]})]},`top-picks-item-${r}`))},`top-picks-skeleton-${t}`)):C.map((e,t)=>s.jsx("div",{ref:t===C.length-1?U:null,className:"flex flex-col gap-4 min-w-[400px]",children:e.map(l=>s.jsx(ge,{songId:l._id,img:l.coverImage||"/images/placeholder.png",songName:l.title,singerName:l.singer,seekTime:fe(l.duration),onPlay:()=>A(l),isSelected:(o==null?void 0:o._id)===l._id},l._id))},`column-${t}`)),u.topPicks&&s.jsx("div",{className:"flex flex-col gap-4 min-w-[400px]",children:[...Array(5)].map((e,t)=>s.jsxs("div",{className:"flex items-center gap-4 skeleton-wrapper",children:[s.jsx(i,{height:50,width:50,className:"rounded-full"}),s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsx(i,{width:120,height:14}),s.jsx(i,{width:80,height:12})]})]},`loading-more-${t}`))})]})})]}),Z&&P&&s.jsx(me,{itemType:K,itemId:P._id,amount:P.price,onClose:()=>{B(!1),D(null),F(null)}})]})]})};export{Le as default};
