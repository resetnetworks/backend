import{u as E,a as M,r as n,b as o,n as U,j as t,N as B,O as D,o as O,p as $}from"./index-Bq32TEZ8.js";import{F as z}from"./index-BB54KNlg.js";import{U as L}from"./UserLayout-yuTYACIF.js";import{U as q}from"./UserHeader-qhcX_yJu.js";import{R as d,A as H}from"./AlbumCard-B1j6kRLN.js";import{O as K}from"./OneTimePaymentModal-Trly3YgJ.js";import"./iconBase-Cst9Bakk.js";import"./IconHeader-BhAI_0tO.js";import"./assets-Dbh41_OJ.js";import"./index-rtsjbbxS.js";import"./index-B6qKfaA3.js";import"./index-DsaIwXDl.js";const ie=()=>{var w,N,S,v,P,A;const r=E(),x=M(),[c,C]=n.useState(""),[_,h]=n.useState(!1),[m,p]=n.useState(null),[k,u]=n.useState(null),{results:s,loading:F,error:g}=o(e=>e.search),I=o(e=>e.songs.songs),i=o(e=>e.player.selectedSong),l=o(e=>e.auth.user);n.useEffect(()=>{r(U())},[r]);const f=()=>{c.trim()!==""?r(B(c)):r(D())},j=e=>{r(O(e)),r($())},b=(e,a)=>{p(e),u(a),h(!0)},R=(e,a)=>[...e].sort(()=>.5-Math.random()).slice(0,a),y=e=>{var a;return e.price===0?"album":e.accessType==="purchase-only"?(a=l==null?void 0:l.purchasedSongs)!=null&&a.includes(e._id)?"Purchased":t.jsxs("button",{className:"bg-indigo-600 hover:bg-indigo-700 text-white sm:text-xs text-[10px] sm:px-2 px-1 sm:mt-0 py-1 rounded",onClick:()=>b(e,"song"),children:["₹",e.price]}):"Subs.."},T=e=>{var a;return e.price===0?"subs..":(a=l==null?void 0:l.purchasedAlbums)!=null&&a.includes(e._id)?"Purchased":t.jsxs("button",{className:"bg-indigo-600 hover:bg-indigo-700 text-white sm:text-xs text-[10px] sm:px-2 px-1 sm:mt-0 py-1 rounded",onClick:()=>b(e,"album"),children:["₹",e.price]})};return t.jsxs(L,{children:[t.jsx(q,{}),t.jsx("h1",{className:"text-xl text-center leading-none text-white",children:"Search by artist, album, or song"}),t.jsx("div",{className:"w-full flex flex-col items-center px-8 sticky top-2 z-10 pt-4",children:t.jsxs("div",{className:"flex items-center w-full max-w-3xl mx-auto p-[2px] rounded-2xl searchbar-container shadow-inner shadow-[#7B7B7B47] bg-gray-700",children:[t.jsxs("div",{className:"flex items-center flex-grow rounded-l-2xl bg-gray-700",children:[t.jsx(z,{className:"text-white mx-3",size:20}),t.jsx("input",{type:"text",placeholder:"Type here...",className:"w-full bg-transparent text-white placeholder-gray-400 py-2 pr-4 outline-none",value:c,onChange:e=>C(e.target.value),onKeyDown:e=>{e.key==="Enter"&&f()}})]}),t.jsx("button",{className:"bg-gradient-to-r from-[#1b233dfe] via-[#0942a4e1] via-40% to-[#0C63FF] text-white font-semibold py-2 px-6 rounded-r-2xl border-[1px] searchbar-button",onClick:f,children:"Search"})]})}),t.jsxs("div",{className:"flex flex-col items-start mt-10 px-6",children:[F&&t.jsx("p",{className:"text-white mt-4",children:"Loading..."}),g&&t.jsx("p",{className:"text-red-400 mt-4",children:g}),c.trim()?t.jsxs(t.Fragment,{children:[((w=s==null?void 0:s.songs)==null?void 0:w.length)>0&&t.jsxs(t.Fragment,{children:[t.jsx("h2",{className:"text-blue-500 font-bold text-lg mt-6 mb-2",children:"Songs"}),t.jsx("div",{className:"flex flex-wrap gap-6",children:s.songs.map(e=>{var a;return t.jsx(d,{title:e.title,price:y(e),singer:((a=e.artist)==null?void 0:a.name)||"Unknown",image:e.coverImage||"/images/placeholder.png",onPlay:()=>j(e),isSelected:(i==null?void 0:i._id)===e._id},e._id)})})]}),((N=s==null?void 0:s.artists)==null?void 0:N.length)>0&&t.jsxs(t.Fragment,{children:[t.jsx("h2",{className:"text-blue-500 font-bold text-lg mt-8 mb-2",children:"Artists"}),t.jsx("div",{className:"flex flex-wrap gap-6",children:s.artists.map(e=>t.jsx(d,{title:e.name,price:"Artist",singer:"Artist",image:e.image||"/images/placeholder.png",onPlay:()=>x(`/artist/${e.slug}`)},e._id))})]}),((S=s==null?void 0:s.albums)==null?void 0:S.length)>0&&t.jsxs(t.Fragment,{children:[t.jsx("h2",{className:"text-blue-500 font-bold text-lg mt-8 mb-2",children:"Albums"}),t.jsx("div",{className:"flex flex-wrap gap-6",children:s.albums.map(e=>{var a;return t.jsx("div",{children:t.jsx(H,{tag:`#${e.title||"music"}`,artists:((a=e.artist)==null?void 0:a.name)||"Various Artists",image:e.coverImage||"/images/placeholder.png",price:T(e),onClick:()=>x(`/album/${e.slug}`)})},e._id)})})]}),((v=s==null?void 0:s.songs)==null?void 0:v.length)===0&&((P=s==null?void 0:s.artists)==null?void 0:P.length)===0&&((A=s==null?void 0:s.albums)==null?void 0:A.length)===0&&t.jsx("p",{className:"text-white/70 mt-8",children:"No results found."})]}):t.jsxs(t.Fragment,{children:[t.jsx("h2",{className:"text-white text-lg mt-6 mb-2",children:"Discover New Songs, Artists And Albums"}),t.jsx("div",{className:"flex flex-wrap gap-6",children:R(I,10).map(e=>{var a;return t.jsx(d,{title:e.title,price:y(e),singer:((a=e.artist)==null?void 0:a.name)||"Unknown Artist",image:e.coverImage||"/images/placeholder.png",onPlay:()=>j(e),isSelected:(i==null?void 0:i._id)===e._id},e._id)})})]})]}),_&&m&&t.jsx(K,{itemType:k,itemId:m._id,amount:m.price,onClose:()=>{h(!1),p(null),u(null)}})]})};export{ie as default};
